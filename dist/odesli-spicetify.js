!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var o,a,n,e;a={amazonMusic:"Amazon Music",amazonStore:"Amazon Appstore",anghami:"Anghami",appleMusic:"Apple Music",audiomack:"Audiomack",audius:"Audius",boomplay:"Boomplay",deezer:"Deezer",itunes:"iTunes",napster:"Napster",pandora:"Pandora",soundcloud:"SoundCloud",spinrilla:"Spinrilla",tidal:"Tidal",yandex:"Yandex Music",youtube:"YouTube",youtubeMusic:"YouTube Music"},n={},e=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));Spicetify.Player.addEventListener("songchange",e=>{"true"==Spicetify.LocalStorage.get("odesli-autoFetch")&&r([null==e?void 0:e.data.item.uri])});var e,i=[],t=new Spicetify.Menu.Item("Automatically fetch links on song change","true"==Spicetify.LocalStorage.get("odesli-autoFetch"),e=>{e.setState(!e.isEnabled),Spicetify.LocalStorage.set("odesli-autoFetch",e.isEnabled)});for(e in i.push(t),a)i.push(function(i){return new Spicetify.Menu.Item(`Show ${a[i]} option`,"true"==Spicetify.LocalStorage.get("odesli-"+i),e=>{e.setState(!e.isEnabled),Spicetify.LocalStorage.set("odesli-"+i,e.isEnabled),o.deregister(),(o=s(u())).register()})}(e));for((o=s(u())).register(),new Spicetify.Menu.SubMenu("Odesli settings",i).register();!Spicetify.Player.data;)await new Promise(e=>setTimeout(e,100));"true"==Spicetify.LocalStorage.get("odesli-autoFetch")&&r([null==(t=Spicetify.Player.data)?void 0:t.item.uri])},(async()=>{await e()})();function c(a){return new Promise(async(e,i)=>{try{var t=await(await(await fetch("https://ipinfo.io/json")).json()).country,o=`https://api.song.link/v1-alpha.1/links?url=${encodeURIComponent(a)}&userCountry=`+t;e((await(await fetch("https://cors-proxy.spicetify.app/"+o)).json()).linksByPlatform)}catch(e){i(e)}})}function i(e){switch(Spicetify.URI.fromString(e[0]).type){case"track":case"album":return!0}return!1}function r(i){c(i[0]).then(async e=>{n[i[0]]=e}).catch(e=>console.error("Error:",e))}function t(i){return new Spicetify.ContextMenu.Item(`Copy ${a[i]} link`,e=>async function(i,t){async function o(e){e?(await Spicetify.Platform.ClipboardAPI.copy(e),Spicetify.showNotification(a[t]+" link copied to the clipboard")):Spicetify.showNotification(a[t]+" link is unavailable")}n&&i[0]in n?o(t in n[i[0]]?n[i[0]][t].url:null):(Spicetify.showNotification(`Searching for ${a[t]} link, please wait...`),c(i[0]).then(async e=>{o(t in e?(n[i[0]]=e)[t].url:null)}).catch(e=>console.error("Error:",e)))}(e,i),()=>!0,Spicetify.SVGIcons.copy,!1)}function s(e){return new Spicetify.ContextMenu.SubMenu("Odesli",e,i,!1)}function u(){var e,i=[];for(e in a)"true"==Spicetify.LocalStorage.get("odesli-"+e)&&i.push(t(e));return i}}();